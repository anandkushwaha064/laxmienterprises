<div class="item-register-container">
    <h2>Register New Item</h2>
    <form (ngSubmit)="onSubmit(itemForm)" #itemForm="ngForm">


        <!-- Bootstrap Row for Form Layout -->
        <div class="row g-3">

            <!-- Barcode Scanner Button -->
            <div class="col-md-12">
                <label for="barcode" class="form-label">Barcode</label>
                <div class="input-group">
                    <input type="text" id="barcode" name="barcode" class="form-control" [(ngModel)]="item.barcode"
                        placeholder="Scan or enter barcode" #barcode="ngModel" />
                    <button type="button" class="btn btn-secondary" (click)="startBarcodeScanner()">
                        Scan Barcode
                    </button>
                </div>
            </div>
            <div class="col-md-12">
                <label for="camera-select" class="form-label">Select Camera</label>
                <select id="camera-select" class="form-control" [(ngModel)]="selectedCameraId" name="camera-select">
                  <option *ngFor="let camera of availableCameras" [value]="camera.deviceId">{{ camera.label }}</option>
                </select>
              </div>

            <!-- Scanner Video Feed -->
            <div class="col-md-12 mt-3" *ngIf="scanning">
                <video #scanner id="barcode-scanner-video" autoplay></video>
            </div>

            <!-- Item Name -->
            <div class="col-md-12">
                <label for="itemName" class="form-label">Item Name</label>
                <input type="text" id="itemName" name="itemName" class="form-control" required minlength="3"
                    [(ngModel)]="item.itemName" #itemName="ngModel"
                    [ngClass]="{'is-invalid': itemName.invalid && itemName.touched, 'is-valid': itemName.valid && itemName.touched}" />
                <div class="invalid-feedback" *ngIf="itemName.invalid && itemName.touched">
                    Item Name is required (min. 3 characters)
                </div>
                <div class="valid-feedback">Looks good!</div>
            </div>

            <!-- Price -->
            <div class="col-md-6">
                <label for="price" class="form-label">Price</label>
                <input type="number" id="price" name="price" class="form-control" required min="0"
                    [(ngModel)]="item.price" #price="ngModel"
                    [ngClass]="{'is-invalid': price.invalid && price.touched, 'is-valid': price.valid && price.touched}" />
                <div class="invalid-feedback" *ngIf="price.invalid && price.touched">
                    Price is required and must be a positive number
                </div>
                <div class="valid-feedback">Looks good!</div>
            </div>

            <!-- Quantity and Quantity Type -->
            <div class="col-md-6">
                <label for="quantity" class="form-label">Quantity</label>
                <input type="number" id="quantity" name="quantity" class="form-control" required min="1"
                    [(ngModel)]="item.quantity" #quantity="ngModel"
                    [ngClass]="{'is-invalid': quantity.invalid && quantity.touched, 'is-valid': quantity.valid && quantity.touched}" />
                <div class="invalid-feedback" *ngIf="quantity.invalid && quantity.touched">
                    Quantity is required and must be greater than 0
                </div>
                <div class="valid-feedback">Looks good!</div>
            </div>

            <!-- Quantity Type -->
            <div class="col-md-6">
                <label for="quantityType" class="form-label">Quantity Type</label>
                <select id="quantityType" name="quantityType" class="form-control" required
                    [(ngModel)]="item.quantityType" #quantityType="ngModel"
                    [ngClass]="{'is-invalid': quantityType.invalid && quantityType.touched, 'is-valid': quantityType.valid && quantityType.touched}">
                    <option value="" disabled>Select Quantity Type</option>
                    <option value="pieces">Pieces</option>
                    <option value="kg">Kilogram</option>
                    <option value="gram">Gram</option>
                    <option value="liters">Liters</option>
                </select>
                <div class="invalid-feedback" *ngIf="quantityType.invalid && quantityType.touched">
                    Quantity Type is required
                </div>
                <div class="valid-feedback">Looks good!</div>
            </div>

            <!-- Category -->
            <div class="col-md-6">
                <label for="category" class="form-label">Category</label>
                <select id="category" name="category" class="form-control" required [(ngModel)]="item.category"
                    #category="ngModel"
                    [ngClass]="{'is-invalid': category.invalid && category.touched, 'is-valid': category.valid && category.touched}">
                    <option value="" disabled>Select Category</option>
                    <option value="electronics">Electronics</option>
                    <option value="furniture">Furniture</option>
                    <option value="clothing">Clothing</option>
                </select>
                <div class="invalid-feedback" *ngIf="category.invalid && category.touched">
                    Category is required
                </div>
                <div class="valid-feedback">Looks good!</div>
            </div>

            <!-- Description -->
            <div class="col-md-12">
                <label for="description" class="form-label">Description</label>
                <textarea id="description" name="description" class="form-control" [(ngModel)]="item.description"
                    #description="ngModel"
                    [ngClass]="{'is-valid': description.valid && description.touched}"></textarea>
                <div class="valid-feedback">Looks good!</div>
            </div>

            <!-- Submit Button -->
            <div class="col-md-10"></div>
            <div class="col-md-2">
                <button type="submit" class="btn btn-primary w-100" [disabled]="itemForm.invalid">Register Item</button>
            </div>

        </div> <!-- End of Bootstrap Row -->
    </form>
</div>